<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="assets/icon.png" sizes="26x26">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <meta name="description" content="Search your favorite recipes."> 
    <!--Icons.-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0" />

    <title>QuickNom RecipeSearch</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Merriweather&family=Roboto&family=Roboto+Slab&family=Ubuntu&display=swap');

        :root{
            --background-color: #222831;
            --search-btn-color: #DCD6F7;
            --feeling-lucky-btn-color: #A6B1E1;
            --bold-font: 'Archivo Black', sans-serif;
        }
        body {
            /* font-family: 'Ubuntu', sans-serif; */
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
        }

        .font-primary{
            font-family: var(--bold-font);
            color: #DCD6F7;
        }

        h1 {
            text-align: center;
        }

        .add-recipe {
            text-align: center;
            margin: 20px;
        }

        input[type="text"] {
            padding: 5px;
            margin-right: 10px;
        }

        button {
            padding: 5px 10px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        .search-btn{
            background-color: var(--search-btn-color);
        }
        
        .feeling-lucky-btn{
            background-color: var(--feeling-lucky-btn-color);
        }

        .recipe-list {
            margin: 20px;
        }

        .recipe-item {
            border: 2px solid #DCD6F7;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
        }
 
        .recipe-image {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
        }

        a{
            text-decoration: none;
        }

        .search-btn{
            border: 2px solid var(--search-btn-color);
            color: #fff;
            padding: 10px 10px;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            transition-duration: 0.4s;
            background-color: transparent;
            /* font-family: var(--btn-font); */
        }
        .search-btn:hover{
            background-color: var(--search-btn-color);
            color: var(--background-color);
        }
        .feeling-lucky-btn{
            border: 2px solid var(--feeling-lucky-btn-color);
            color: #fff;
            padding: 10px 10px;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            transition-duration: 0.4s;
            background-color: transparent;
            /* font-family: var(--btn-font); */
        }
        .feeling-lucky-btn:hover{
            background-color: var(--feeling-lucky-btn-color);
            color: var(--background-color);
        }
        .load-more-btn{
            border: 2px solid var(--feeling-lucky-btn-color);
            color: #fff;
            padding: 10px 10px;
            width: 90%;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            transition-duration: 0.4s;
            background-color: transparent;
            /* font-family: var(--btn-font); */
        }
        .load-more-btn:hover{
            background-color: var(--feeling-lucky-btn-color);
            color: var(--background-color);
        }

    </style>
</head>
<body>
    <br>
    <h1 class="font-primary">QuickNom</h1>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <div class="add-recipe">
        <div class="input-group mb-3">
            <input type="text" class="form-control" id="ingredientInput" placeholder="Enter ingredients separated by commas">
            <button onclick="searchRecipesByIngredients()" class="search-btn">Search</button>
            <!-- <button onclick="loadPopularRecipes()" class="feeling-lucky-btn">Feeling Lucky</button> -->
        </div>
        <br>
    </div>
    <h3 class="font-primary" style="padding-left: 20px;">Here are some popular recipes</h3>
    <div class="recipe-list" id="popular-recipes">
    </div>
    <button onclick="loadMoreRecipes()" class="load-more-btn">Load More</button>
    <footer style="text-align: center; margin-top: 20px;" class="font-primary">
        Made with ❤️ by <a href="https://errolm.netlify.app">ErrolM</a>
    </footer>

    <script>
        const edamamAppId = "2f4013c4";
        const edamamAppKey = "173b04b81fbfda990d7c78c089bb5569";

        function searchRecipesByIngredients() {
            const ingredients = document.getElementById("ingredientInput").value;
            const apiUrl = `https://api.edamam.com/search?q=${encodeURIComponent(ingredients)}&app_id=${edamamAppId}&app_key=${edamamAppKey}`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const recipeList = document.querySelector(".recipe-list");
                    recipeList.innerHTML = "";

                    if (data.hits && data.hits.length > 0) {
                        data.hits.forEach(recipe => {
                            const recipeInfo = recipe.recipe;

                            const recipeItem = document.createElement("div");
                            recipeItem.classList.add("recipe-item");
                            recipeItem.innerHTML = `
                            <center><h3>${recipeInfo.label}</h3>
                                <img class="recipe-image" src="${recipeInfo.image}" alt="${recipeInfo.label}"></center>
                                <p>Calories: ${recipeInfo.calories.toFixed(2)}</p>
                                <p>Servings: ${recipeInfo.yield}</p>
                                <a href="${recipeInfo.url}" target="_blank">View Recipe</a>
                            `;
                            recipeList.appendChild(recipeItem);
                        });
                    } else {
                        recipeList.innerHTML = "No results found. Try different ingredients.";
                    }
                })
                .catch(error => {
                    console.error("Error fetching recipe data:", error);
                });
        }

        // function getRandomRecipe() {
        //     const apiUrl = `https://api.edamam.com/search?q=*&app_id=${edamamAppId}&app_key=${edamamAppKey}&from=0&to=1`;

        //     fetch(apiUrl)
        //         .then(response => response.json())
        //         .then(data => {
        //             const recipeList = document.querySelector(".recipe-list");
        //             recipeList.innerHTML = "";

        //             if (data.hits && data.hits.length > 0) {
        //                 const randomRecipe = data.hits[0].recipe;

        //                 const recipeItem = document.createElement("div");
        //                 recipeItem.classList.add("recipe-item");
        //                 recipeItem.innerHTML = `
        //                     <h3>${randomRecipe.label}</h3>
        //                     <img class="recipe-image" src="${randomRecipe.image}" alt="${randomRecipe.label}">
        //                     <p>Calories: ${randomRecipe.calories.toFixed(2)}</p>
        //                     <p>Servings: ${randomRecipe.yield}</p>
        //                     <a href="${randomRecipe.url}" target="_blank">View Recipe</a>
        //                 `;
        //                 recipeList.appendChild(recipeItem);
        //             } else {
        //                 recipeList.innerHTML = "No results found.";
        //             }
        //         })
        //         .catch(error => {
        //             console.error("Error fetching random recipe data:", error);
        //         });
        // }

        function loadPopularRecipes() {
            const popularRecipesUrl = `https://api.edamam.com/search?q=popular&app_id=${edamamAppId}&app_key=${edamamAppKey}`;

            fetch(popularRecipesUrl)
                .then(response => response.json())
                .then(data => {
                    const popularRecipeList = document.getElementById("popular-recipes");
                    popularRecipeList.innerHTML = "";

                    if (data.hits && data.hits.length > 0) {
                        data.hits.forEach(recipe => {
                            const recipeInfo = recipe.recipe;

                            const recipeItem = document.createElement("div");
                            recipeItem.classList.add("recipe-item");
                            recipeItem.innerHTML = `
                                <center><h3>${recipeInfo.label}</h3>
                                <img class="recipe-image" src="${recipeInfo.image}" alt="${recipeInfo.label}"></center>
                                <p>Calories: ${recipeInfo.calories.toFixed(2)}</p>
                                <p>Servings: ${recipeInfo.yield}</p>
                                <a href="${recipeInfo.url}" target="_blank">View Recipe</a>
                            `;
                            popularRecipeList.appendChild(recipeItem);
                        });
                    } else {
                        popularRecipeList.innerHTML = "No popular recipes found.";
                    }
                })
                .catch(error => {
                    console.error("Error fetching popular recipe data:", error);
                });
        }

        let nextPage = 1; // result page

function loadMoreRecipes() {
    const popularRecipesUrl = `https://api.edamam.com/search?q=popular&app_id=${edamamAppId}&app_key=${edamamAppKey}&from=${nextPage * 10}&to=${(nextPage + 1) * 10}`;

    fetch(popularRecipesUrl)
        .then(response => response.json())
        .then(data => {
            const popularRecipeList = document.getElementById("popular-recipes");

            if (data.hits && data.hits.length > 0) {
                data.hits.forEach(recipe => {
                    const recipeInfo = recipe.recipe;

                    const recipeItem = document.createElement("div");
                    recipeItem.classList.add("recipe-item");
                    recipeItem.innerHTML = `
                        <center><h3>${recipeInfo.label}</h3>
                        <img class="recipe-image" src="${recipeInfo.image}" alt="${recipeInfo.label}"></center>
                        <p>Calories: ${recipeInfo.calories.toFixed(2)}</p>
                        <p>Servings: ${recipeInfo.yield}</p>
                        <a href="${recipeInfo.url}" target="_blank">View Recipe</a>
                    `;
                    popularRecipeList.appendChild(recipeItem);
                });

                nextPage++; 
            } else {
                // hidin' load more btn
                document.querySelector(".load-more-btn").style.display = "none";
            }
        })
        .catch(error => {
            console.error("Error fetching popular recipe data:", error);
        });
}

        // Man, this took a long time.
        document.addEventListener("DOMContentLoaded", loadPopularRecipes);
    </script>
</body>
</html>
